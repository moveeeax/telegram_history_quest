# README.md: Telegram-бот для квеста "Иван Грозный в эпоху Великих реформ"

## Описание проекта
Этот проект представляет собой Telegram-бот, реализующий интерактивный исторический квест. В квесте Иван Грозный "попадает" в эпоху Великих реформ Александра II (1860-е годы). Бот отправляет унифицированные "карточки" с изображениями, текстом сюжета/задания и кнопками для выбора ответов. Задания хранятся в текстовых файлах в папке `tasks/`, что позволяет легко добавлять или модифицировать квесты.

Проект создан на Python с использованием библиотеки `telebot` (pyTelegramBotAPI). Подходит для образовательных целей, соответствует требованиям творческого задания по истории и цифровым технологиям (НЭТИ, А.К. Кириллов).

## Требования
- **Операционная система**: Windows (протестировано на Windows 10/11).
- **Python**: Версия 3.8 или выше (рекомендуется 3.12).
- **Зависимости**: `pyTelegramBotAPI` (для работы с Telegram API).
- **Telegram**: Аккаунт для создания бота через @BotFather.
- **Интернет**: Для работы бота (обмен с Telegram серверами).

## Установка
### Шаг 1: Установите Python
1. Скачайте установщик Python с официального сайта: [python.org/downloads](https://www.python.org/downloads/).
2. Выберите версию 3.12 (или выше) для Windows.
3. Во время установки:
   - Отметьте галочку "Add Python to PATH" (чтобы Python был доступен из командной строки).
   - Установите pip (он идёт по умолчанию).
4. Проверьте установку: Откройте Командную строку (cmd.exe) и введите `python --version`. Должно вывести версию Python.

### Шаг 2: Создайте директорию проекта
1. Создайте папку для проекта, например, `C:\Projects\GroznyQuestBot`.
2. Перейдите в неё через cmd: `cd C:\Projects\GroznyQuestBot`.
3. Скачайте или скопируйте файлы проекта:
   - `bot.py` (основной скрипт).
   - Папка `tasks/` с примерами .txt-файлов (intro.txt, peasant.txt и т.д.).

### Шаг 3: Установите зависимости
1. В cmd (в директории проекта) выполните:
   ```
   pip install pyTelegramBotAPI
   ```
   Это установит библиотеку `telebot` для работы с Telegram.

### Шаг 4: Создайте Telegram-бота
1. Откройте Telegram и найдите @BotFather.
2. Напишите `/newbot` и следуйте инструкциям:
   - Укажите имя бота (например, GroznyReformQuestBot).
   - Укажите username (должен заканчиваться на _bot, например, GroznyReformQuestBot).
3. BotFather выдаст API-токен (выглядит как `123456:ABC-DEF1234ghIkl-zyx57W2v1u123ew11`).
4. Откройте файл `bot.py` в текстовом редакторе (Notepad++ или VS Code).
5. Замените `'YOUR_TOKEN'` на ваш токен:
   ```
   bot = telebot.TeleBot('ВАШ_ТОКЕН_ЗДЕСЬ')
   ```

## Запуск проекта
1. В cmd (в директории проекта) выполните:
   ```
   python bot.py
   ```
   Бот запустится и будет "слушать" запросы от Telegram.
2. В Telegram найдите вашего бота по username и напишите `/start`.
3. Бот отправит первую карточку квеста. Кликайте на кнопки для прохождения.

**Примечание для Windows**: Если возникает ошибка "ModuleNotFoundError: No module named 'telebot'", убедитесь, что pip установил библиотеку правильно. Попробуйте `pip install --user pyTelegramBotAPI` или проверьте PATH.

Чтобы остановить бота: Нажмите Ctrl+C в cmd.

## Как писать свои квесты
Задания хранятся в папке `tasks/` как отдельные .txt-файлы. Каждый файл — один этап квеста (карточка). Бот автоматически читает их по именам (без .txt).

### Формат .txt-файла
Файл должен быть в кодировке UTF-8 (стандарт для Windows Notepad). Структура:
```
Текст: [Сюжетный текст + задание/вопрос. До 400 символов, чтобы поместилось в caption Telegram. Включите исторические факты для демонстрации знаний.]

Image: [URL на изображение. Используйте исторические картинки из открытых источников, например, Wikimedia. Или сгенерированные AI, соответствующие эпохе.]

Buttons:
[Текст кнопки 1]: [next_stage или wrong_stage или end]
[Текст кнопки 2]: [next_stage или wrong_stage или end]
...
```
- **Текст**: Сюжет + исторический факт (например, "Иван видит Манифест 1861: освобождение крестьян с выкупными платежами.").
- **Image**: Ссылка на картинку (https://...). Она отобразится в сообщении.
- **Buttons**: Каждая строка — кнопка и её callback.
  - `correct_stage`: Имя следующего файла (без .txt), для правильного ответа.
  - `wrong_stage`: Для неправильного — бот отправит объяснение и кнопку "Продолжить".
  - `end`: Завершить квест.
  - `continue`: Просто перейти дальше (для нарратива без выбора).

### Пример: Новый файл `new_stage.txt`
```
Текст: Иван встречает Александра II. "Что за реформы?" Факт: Великие реформы 1860-х модернизировали Россию, отменив крепостное право.

Image: https://example.com/alexander_ii.jpg

Buttons:
Правильный ответ: next_stage
Неправильный: wrong_new
Продолжить: next_stage
```

### Добавление квеста
1. Создайте .txt в `tasks/`.
2. В предыдущем файле укажите в Buttons ссылку на новый (например, `Мой новый этап: new_stage`).
3. Перезапустите бота — изменения подхватятся автоматически.

### Советы
- **Изображения**: Используйте релевантные исторические (картины Репина, фото 19 в.). Укажите источники в финальном этапе для "товарного вида".
- **Ветвления**: Для wrong_ добавьте в код бота кастомные объяснения (в callback_handler).
- **Тестирование**: Запустите бота и пройдите квест. Если ошибка — проверьте пути к файлам.
- **Расширение**: Добавьте музыку (bot.send_audio) или карты, если нужно.

## Титры и кредиты
В финальном файле (final.txt) добавьте:
- Имя автора, вуз (НЭТИ), год (2025).
- Источники изображений/музыки.

Проект готов к размещению на sibistorik.ru. Если проблемы — проверьте логи в cmd.

Автор: [Ваше имя]  
Дата: 17 ноября 2025